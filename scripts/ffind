# /bin/sh
#echo "searching the following locations: ${@:-.}"

# optional argument to specify depth of search
# user would specify this like "-d 2" for example

depth=""
directories="."

# parse arguments
# -d is the depth argument
# all other arguments should be directories and will be searched
# if no directories are specified, the current directory will be searched
while getopts ":d:" opt; do
  case $opt in
    d)
      depth="$OPTARG"
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      ;;
  esac
done

shift $((OPTIND -1))

# Directories passed in as non-option arguments

# if no directories are left in $@, use the current directory
if [ -z "$@" ]; then
    directories="."
fi


# otherwise, search all directories
if [ -z "$depth" ]; then
    find $directories -type f,d  | fzf
else
    find $directories -maxdepth $depth  -type f,d  | fzf
fi
